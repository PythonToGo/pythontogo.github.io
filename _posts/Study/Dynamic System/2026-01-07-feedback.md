---
title: Feedback Linearization
description: Summary of PassivFeedback Linearizationity
date: 2026-01-07 05:00:00
categories: [Study, Dynamic System]
author: PythonToGo
tags: [Dynamic System, Coordinate Transformation, Lineaerization, Lie Derivative, I/O Linearization, Full-State Linearization, Diffeomorphism]
# pin: true
math: true
mermaid: true
comments: true
image: 
#     # type: pdf
    path: assets/img/posts/study-ds/ds6_front.png

#     # page: 7
#     alt: 
---
{% include pdf-viewer.html %}


# Feedback Linearization

Feedback Linearization은 근사치에 의존하는 Taylor Series Lineaerization과 달리, **Coordinate Transform**과 **non-linear feedback control input**을 사용해 시스템을 비선형성을 없애고, 선형 시스템으로 변환하는 기법이다. 


<div style="display: flex; gap: 2rem; margin: 2rem 0;">
  <div style="flex: 1;">
    <img src="assets/img/posts/study-ds/ch7_talyor.png" alt="Taylor Series" style="width: 100%; margin-bottom: 1rem;">
    <p><strong>Taylor Series Linearization</strong> : An approximation valid only in a small neighborhood around an operating point.</p>
  </div>
  <div style="flex: 1;">
    <img src="assets/img/posts/study-ds/ch7_feedbackLin.png" alt="Feedback Linearization" style="width: 100%; margin-bottom: 1rem;">
    <p><strong>Feedback Linearization</strong> : An <em>exact</em> system transformation, creating an equivalent linear system through a change of coordinates and feedback. Valid over a much larger region of the state space.</p>
  </div>
</div>



## Lie Algebra

피드백 선형화를 이해하기 위해서는 , 미분 기하학적 도구인 **Lie Derivative** and **Lie Bracket**이 필요하다.

### Lie Derivative

스칼라함수 $$h(x)$$를 벡터 필드 **f(x)**방향으로 미분하는 것을 의미한다.

$$
L_f h := \nabla h \cdot f = \frac{\partial h}{\partial x } f(x)
$$

이것을 여러번 미분하면 시리즈화 되는데, 형식은 다음 과 같다. 

$$
L^0_f h = h \text{  , } L^i_f h = L_f L^{i-1}_f h
$$

> Measures the rate of change of a function $$h$$ along the vector field $$f$$.


### Lie Bracket

두 벡터 필드 $$f$$와 $$g$$ 사이의 연산으로, 다음 처럼 정의된다.

$$
[f, g] := L_f g - L_g f = \frac{\partial g}{\partial x} f - \frac{\partial f}{\partial x} g
$$

> Captures the non-commutativity of flows along vector fields $$f$$ and $$g$$.

마찬가지로 이것을 여러번 반복하면 시리즈화 되는데 이것을 *Ad Operator* 연산자를 사용한다.


### Ad Operator

Lie Bracket을 반복적으로 적용하는 연산자로, 다음과같이 정의된다.

$$
{ad}^0_f g = g \text{  ,  } {ad}^i_f g = [f, {ad}^{i-1}_f g]
$$

> Provides a compact notation fo repeated Lie Bracket


> **Relative Degree**
>
> The system $$\dot{x} = f(x) + g(x)$$,  $$y = h(x)$$ has the *relative degree* $$r$$ at point $$x^\circ$$ if the following holds:
>
> - For all $$x$$ in the neighborhood of $$x^\circ$$ and $$ k < r - 1$$:
> <center>$$ L_g L^k_f h(x) = 0 $$</center>
>
> - $$L_g L^{r-1}_f h(x^\circ) \neq 0$$
{: .prompt-info}



## Input/Output (I/O) Linearization

시스템의 출력을 반복적으로 미분해서 입력 $$u$$가 직접 나타나게 함으로써 입출력 관계를 선형화하는 방법이다. 여기서 방금 언급한 Relative Degree가 사용된다. 

### Relative Degree $$r$$

출력 $$y$$를 $$r$$번 미분했을때, 비로소 입력 $$u$$가 식에 나타나는 경우, 이 시스템은 상대 차수 $$r$$를 가진다고 한다. 이 조건은 아까 언급한것과 같다. 

<div class="pdf-viewer-container" data-pdf="/assets/img/posts/study-ds/ds7.pdf" data-page="4"></div>

다시말해 $$k > r - 1 \text{  에 대해 } L_g L^k_f h(x) = 0 \text{ 이고, } L_g L^{r-1}_f(x^\circ) \neq 0$$ 이어야한다.


### Linearizing Control Law -  선형화 제어 법칙


<div class="pdf-viewer-container" data-pdf="/assets/img/posts/study-ds/ds7.pdf" data-page="5"></div>


$$r$$번째 미분 식 $$y^{(r)} = L^r_f h(x) + L_g L^{r-1}_f h(x) u$$에서, 다음과 같은 Control Input, 제어입력을 설계한다.

$$
u(x, v) = \frac{1}{L_g L^{r-1}_f h(x)} (v - L^r_f h(x))
$$

이때 $$v$$는 *새로운 가상의 입력*이며, 최종적으로는 $$y^{(r)} = v^{**}$$라는 선형적인 **integrator chain** 관계를 얻게 된다.

이걸 왜하냐?
여러번 미분한 $$y^{(r)}= v$$를 새로운 문자로 사용할 수 있고, 그럼 여러차원의 미분의 계산이 매우 쉬워진다. 


<div class="pdf-viewer-container" data-pdf="/assets/img/posts/study-ds/ds7-correct.pdf" data-page="1"></div>


그럼 우리는 두 가지 케이스가 나온다.
- $$r=n$$ : 이렇게 되면 풀랭크이고, $$n \times n$$ 매트릭스의 formular가 온전하니까 Control Law를 사용하는데 전혀 문제가 없다. 
- $$ r < n$$ : 이렇게 되면 어떻게 될까? 이때는 **internal dynamics**로 고려해야한다. 


### Internal Dynamics and Zero Dynamics - 내부 동역학

상대 차수 $r$이 시스템의 차수$$n$$보다 작은 경우$$r < n$$, 출력에서 보이지 않는 $$n-r$$ 차원의 Internal Dynamics 가 존재한다.

이때 **Zero Dynamics**라고 부르는데, 출력 $$y(t) \equiv 0$$으로 유지될 때의 내부 동역학 거동을의미하며, 이 시스템이 안정하기 위해서는 Zero Dynamics가 반드시 안정해야 한다. 

> **Internal dynamics**
>
> I/O Linearization only transform $$r$$ states. The remaining **$$n - r$$** states from the **internal dynamics**, which are not controlled by $$v$$ or observed through $$y$$.
>
> If these internal dynamics are **unstable**, the entire system cam become unstable even if the input-output behavior appears perfectly controlled
>
> This is the behavior of the internal dynamics when we force the output to be zero, i.e, $$ y(t) \equiv 0$$. The stability of the zero dynamics is a crucial test for the viability of the I/O linearization controller.
{: .prompt-tip}


